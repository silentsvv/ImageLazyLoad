function LazyLoad(t,o,e){var i=this._util={};i.elements=[],i.scrollFn=null,i.resizeFn=null,i.callback=o,i.errorFn=e,i.count=0,i.beforeScrollTime=new Date,i.scrollTimer=null,i.STATUS="scroll",this.option=t||{},this.option.selector=this.option.selector||"[data-src]",this.option.prefix=this.option.prefix||"data-src",this.option.scrollDelay=this.option.scrollDelay||25,this.option.resizeDelay=this.option.resizeDelay||50,this.option.distance=this.option.distance||0,this.option.containerClass=this.option.containerClass||null,this.option.container=this.option.containerClass?document.querySelector(this.option.containerClass):null,this.option.loadingClassName=this.option.loadingClassName||"loading",this.option.loadedClassName=this.option.loadedClassName||"loaded",this.option.preloadImage=this.option.preloadImage||null,this.option.rectScale=this.option.rectScale||1,this.option.forAutoLoad=this.option.forAutoLoad||null,this._viewport={bottom:window.innerHeight+this.option.distance,right:window.innerWidth+this.option.distance,left:0-this.option.distance,top:0-this.option.distance},this.init()}function throttle(t,o,e){var i=0;return function(){var n=+new Date;n-i<o||(i=n,t.apply(e,arguments))}}LazyLoad.prototype.init=function(){var t=this._util;if(t.elements=this.toArray(),t.count=t.elements.length,this.initPreloadImage(),this.scroll(),t.scrollFn=this.scrollThrottle(),t.resizeFn=this.resetViewport(),this.option.container&&(this.bindEvent(this.option.container,"scroll",t.scrollFn),this.bindEvent(this.option.container,"resize",t.resizeFn),this.bindEvent(this.option.container,"resize",t.scrollFn)),this.bindEvent(window,"scroll",t.scrollFn),this.bindEvent(window,"resize",t.resizeFn),this.bindEvent(window,"resize",t.scrollFn),this.option.forAutoLoad){let o=this.checkStopScrollTime();t.scrollTimer=setInterval(o,100)}},LazyLoad.prototype.checkStopScrollTime=function(){let t=this,o=t._util;return function(){new Date-o.beforeScrollTime>t.option.forAutoLoad&&(o.STATUS="stop",clearInterval(o.scrollTimer),t.autoLoadImage())}},LazyLoad.prototype.autoLoadImage=function(){var t=this,o=t._util;if("scroll"==o.STATUS){console.log("继续滚动中");let e=t.checkStopScrollTime();return o.scrollTimer=setInterval(e,100),!1}if(o.elements.length>0){let e=o.elements[0],i=e.getAttribute(t.option.prefix),n=new Image;n.src=i,n.onload=function(){if(e.src=i,e.classList.remove(t.option.loadingClassName),e.classList.add(t.option.loadedClassName),--o.count<=0)return o.callback&&o.callback(),console.log("已经加载完成啦~"),t.destroy(),!1;console.log("自动加载下一副"),t.autoLoadImage()},n.onerror=function(){o.errorFn&&o.errorFn()},o.elements.splice(0,1)}},LazyLoad.prototype.destroy=function(){var t=this._util;this.option.container&&(this.unbindEvent(this.option.container,"scroll",t.scrollFn),this.unbindEvent(this.option.container,"resize",t.resizeFn),this.unbindEvent(this.option.container,"resize",t.scrollFn)),this.unbindEvent(window,"scroll",t.scrollFn),this.unbindEvent(window,"resize",t.resizeFn),this.unbindEvent(window,"resize",t.scrollFn)},LazyLoad.prototype.bindEvent=function(t,o,e){t.attachEvent?t.attachEvent&&t.attachEvent("on"+o,e):t.addEventListener(o,e,{capture:!1,passive:!0})},LazyLoad.prototype.unbindEvent=function(t,o,e){t.attachEvent?t.attachEvent&&t.detachEvent("on"+o,e):t.removeEventListener(o,e,{capture:!1,passive:!0})},LazyLoad.prototype.resetViewport=function(){let t=this;return throttle(function(){this._viewport={bottom:window.innerHeight+t.option.distance,right:window.innerWidth+t.option.distance,left:0-t.option.distance,top:0-t.option.distance}},t.option.resizeDelay,t)},LazyLoad.prototype.scroll=function(){var t=this,o=t._util;o.STATUS="scroll",o.beforeScrollTime=new Date;for(let e=0,i=o.elements.length;e<i;e++){let n=o.elements[e];if(t.checkInView(n,t._viewport)){let s=n.getAttribute(t.option.prefix),l=new Image;l.src=s,l.onload=function(){n.src=s,n.classList.remove(t.option.loadingClassName),n.classList.add(t.option.loadedClassName),--o.count<=0&&o.callback&&o.callback()},l.onerror=function(){o.errorFn&&o.errorFn()},o.elements.splice(e,1),e--,--i<=0&&(console.log("已经加载完成啦~"),t.destroy())}}},LazyLoad.prototype.initPreloadImage=function(){var t=this._util;for(let o=0,e=t.elements.length;o<e;o++){let e=t.elements[o];e.classList.add(this.option.loadingClassName),this.option.preloadImage&&(e.src=this.option.preloadImage)}},LazyLoad.prototype.scrollThrottle=function(){return throttle(function(){this.scroll()},this.option.scrollDelay,this)},LazyLoad.prototype.toArray=function(){let t=[],o=document.querySelectorAll(this.option.selector);for(let e=0,i=o.length;e<i;e++)t.push(o[e]);return t},LazyLoad.prototype.checkInView=function(t,o){let e=t.getBoundingClientRect();return e.right=e.right*this.option.rectScale,e.bottom=e.bottom*this.option.rectScale,e.left=e.left*this.option.rectScale,e.top=e.top*this.option.rectScale,e.right*this.option.rectScale>=o.left&&e.bottom*this.option.rectScale>=o.top&&e.left*this.option.rectScale<=o.right&&e.top*this.option.rectScale<=o.bottom};