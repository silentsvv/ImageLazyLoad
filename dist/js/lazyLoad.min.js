function LazyLoad(o,t,e){var n=this,i=n._util={};i.elements=[],i.scrollFn=null,i.resizeFn=null,i.callback=t,i.errorFn=e,i.count=0,i.beforeScrollTime=new Date,i.scrollTimer=null,i.STATUS="scroll",n.option=o||{},n.option.selector=n.option.selector||"[data-src]",n.option.prefix=n.option.prefix||"data-src",n.option.scrollDelay=n.option.scrollDelay||25,n.option.resizeDelay=n.option.resizeDelay||50,n.option.distance=n.option.distance||0,n.option.containerClass=n.option.containerClass||null,n.option.container=n.option.containerClass?document.querySelector(n.option.containerClass):null,n.option.loadingClassName=n.option.loadingClassName||"loading",n.option.loadedClassName=n.option.loadedClassName||"loaded",n.option.preloadImage=n.option.preloadImage||null,n.option.rectScale=n.option.rectScale||1,n.option.forAutoLoad=n.option.forAutoLoad||null,n._viewport={bottom:window.innerHeight+n.option.distance,right:window.innerWidth+n.option.distance,left:0-n.option.distance,top:0-n.option.distance},n.init()}function throttle(t,e,n){var i=0;return function(){var o=+new Date;o-i<e||(i=o,t.apply(n,arguments))}}LazyLoad.prototype.init=function(){var o=this,t=o._util;if(t.elements=o.toArray(),t.count=t.elements.length,o.initPreloadImage(),o.scroll(),t.scrollFn=o.scrollThrottle(),t.resizeFn=o.resetViewport(),o.option.container&&(o.bindEvent(o.option.container,"scroll",t.scrollFn),o.bindEvent(o.option.container,"resize",t.resizeFn),o.bindEvent(o.option.container,"resize",t.scrollFn)),o.bindEvent(window,"scroll",t.scrollFn),o.bindEvent(window,"resize",t.resizeFn),o.bindEvent(window,"resize",t.scrollFn),o.option.forAutoLoad){var e=o.checkStopScrollTime();t.scrollTimer=setInterval(e,100)}},LazyLoad.prototype.checkStopScrollTime=function(){var o=this,t=o._util;return function(){new Date-t.beforeScrollTime>o.option.forAutoLoad&&(t.STATUS="stop",clearInterval(t.scrollTimer),o.autoLoadImage())}},LazyLoad.prototype.autoLoadImage=function(){var o=this,t=o._util;if("scroll"==t.STATUS){console.log("继续滚动中");var e=o.checkStopScrollTime();return t.scrollTimer=setInterval(e,100),!1}if(0<t.elements.length){var n=t.elements[0],i=n.getAttribute(o.option.prefix),r=new Image;r.src=i,r.onload=function(){if(n.src=i,n.classList.remove(o.option.loadingClassName),n.classList.add(o.option.loadedClassName),--t.count<=0)return t.callback&&t.callback(),console.log("已经加载完成啦~"),o.destroy(),!1;o.autoLoadImage()},r.onerror=function(){t.errorFn&&t.errorFn(),o.autoLoadImage()},t.elements.splice(0,1)}},LazyLoad.prototype.destroy=function(){var o=this,t=o._util;o.option.container&&(o.unbindEvent(o.option.container,"scroll",t.scrollFn),o.unbindEvent(o.option.container,"resize",t.resizeFn),o.unbindEvent(o.option.container,"resize",t.scrollFn)),o.unbindEvent(window,"scroll",t.scrollFn),o.unbindEvent(window,"resize",t.resizeFn),o.unbindEvent(window,"resize",t.scrollFn)},LazyLoad.prototype.bindEvent=function(o,t,e){o.attachEvent?o.attachEvent&&o.attachEvent("on"+t,e):o.addEventListener(t,e,{capture:!1,passive:!0})},LazyLoad.prototype.unbindEvent=function(o,t,e){o.attachEvent?o.attachEvent&&o.detachEvent("on"+t,e):o.removeEventListener(t,e,{capture:!1,passive:!0})},LazyLoad.prototype.resetViewport=function(){var o=this;return throttle(function(){this._viewport={bottom:window.innerHeight+o.option.distance,right:window.innerWidth+o.option.distance,left:0-o.option.distance,top:0-o.option.distance}},o.option.resizeDelay,o)},LazyLoad.prototype.scroll=function(){var n=this,i=n._util;i.STATUS="scroll",i.beforeScrollTime=new Date;for(var r=0,l=i.elements.length;r<l;r++)!function(){var o=i.elements[r];if(n.checkInView(o,n._viewport)){var t=o.getAttribute(n.option.prefix),e=new Image;e.src=t,e.onload=function(){o.src=t,o.classList.remove(n.option.loadingClassName),o.classList.add(n.option.loadedClassName),--i.count<=0&&i.callback&&(i.callback(),console.log("已经加载完成啦~"))},e.onerror=function(){i.errorFn&&i.errorFn()},i.elements.splice(r,1),r--,--l<=0&&(clearInterval(i.scrollTimer),n.destroy())}}()},LazyLoad.prototype.initPreloadImage=function(){for(var o=this,t=o._util,e=0,n=t.elements.length;e<n;e++){var i=t.elements[e];i.classList.add(o.option.loadingClassName),o.option.preloadImage&&(i.src=o.option.preloadImage)}},LazyLoad.prototype.scrollThrottle=function(){console.log("滚动ing~");return throttle(function(){this.scroll()},this.option.scrollDelay,this)},LazyLoad.prototype.toArray=function(){for(var o=[],t=document.querySelectorAll(this.option.selector),e=0,n=t.length;e<n;e++)o.push(t[e]);return o},LazyLoad.prototype.checkInView=function(o,t){var e=this,n=o.getBoundingClientRect();return n.right=n.right*e.option.rectScale,n.bottom=n.bottom*e.option.rectScale,n.left=n.left*e.option.rectScale,n.top=n.top*e.option.rectScale,n.right*e.option.rectScale>=t.left&&n.bottom*e.option.rectScale>=t.top&&n.left*e.option.rectScale<=t.right&&n.top*e.option.rectScale<=t.bottom};